<!DOCTYPE html>
<html>
<head>
<title>Google Drive Direct Link Generator</title>
<style>
body { font-family: sans-serif; }
#linkInput { width: 300px; padding: 10px; margin-bottom: 10px; }
#downloadBtn { padding: 10px; background-color: lightblue; border: none; cursor: pointer; }
</style>
</head>
<body>
  <h2>Google Drive Direct Download Link Generator</h2>
    <input type="text" id="linkInput" placeholder="Paste Google Drive link here">
      <button id="downloadBtn">Generate Direct Link</button>
        <a id="directLink" style="display: none;"></a>

        <script>
        const linkInput = document.getElementById('linkInput');
        const downloadBtn = document.getElementById('downloadBtn');
        const directLink = document.getElementById('directLink');

        downloadBtn.addEventListener('click', async () => {
          const driveLink = linkInput.value;
            const fileId = driveLink.split('/d/')[1].split('/')[0];

              try {
                  // Fetch file metadata using Google Drive API
                      const response = await fetch(`https://www.googleapis.com/drive/v3/files/${fileId}?key=AIzaSyC1AbMGQxr6Fgz27N6VL-jab9wXwyHEJ2g&fields=name`);
                          const data = await response.json();
                              const fileName = data.name;

                                  // Construct the download link using 'webContentLink' and set the file name
                                      directLink.href = `https://drive.google.com/uc?export=download&id=${fileId}`;
                                          directLink.download = fileName; 
                                              directLink.text = 'Download File';
                                                  directLink.style.display = 'block';

                                                    } catch (error) {
                                                        console.error('Error fetching file metadata:', error);
                                                            directLink.text = 'Failed to generate link';
                                                                directLink.style.display = 'block';
                                                                  }
                                                                  });
                                                                  </script>
                                                                  </body>
                                                                  </html>
                                                                  